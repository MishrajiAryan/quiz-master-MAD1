{% extends "layout.html" %}

{% block title %}
Result: {{ quiz.name }}
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="card shadow p-4 mx-auto" style="max-width: 800px; width:90%;">
        <div class="card-body">
            <h1 class="display-5 text-center">Quiz Results</h1>
            <h5 class="text-center">{{ quiz.name }}</h5>
            <hr>

            {% if score %}
            <!-- User Score Progress Bar -->
            <div class="progress mb-3">
                <div class="progress-bar 
                    {% if score.percentage_score < 40 %} bg-danger 
                    {% elif score.percentage_score < 80 %} bg-warning 
                    {% else %} bg-success {% endif %}" 
                    role="progressbar" 
                    style="width: {{score.percentage_score}}%" 
                    aria-valuenow="{{score.percentage_score}}" 
                    aria-valuemin="0" 
                    aria-valuemax="100">
                    {{ score.percentage_score }}%
                </div>
            </div>

            <h5 class="text-center">Your Score: <strong>{{ score.total_score }}</strong> / <strong>{{ score.total_questions }}</strong></h5>
            <h5 class="text-center">Percentage: <strong>{{ score.percentage_score }}%</strong></h5>

            <!-- Feedback Messages -->
            {% if score.percentage_score < 40 %}
            <div class="alert alert-danger text-center" role="alert">Keep practicing! You'll get better with time.</div>
            {% elif score.percentage_score < 80 %}
            <div class="alert alert-warning text-center" role="alert">Good job! A bit more effort, and you'll ace it.</div>
            {% else %}
            <div class="alert alert-success text-center" role="alert">Excellent! You've mastered this quiz!</div>
            {% endif %}

            <h5 class="mt-4">Detailed Results</h5>
            <ul class="list-group">
                {% for question in quiz.questions %}
                <li class="list-group-item">
                    <p><strong>Question {{ loop.index }}:</strong> {{ question.question_statement }}</p>
                    <p><strong>Correct Answer:</strong> 
                        {% if question.correct_option == 1 %}
                            {{ question.option1 }}
                        {% elif question.correct_option == 2 %}
                            {{ question.option2 }}
                        {% elif question.correct_option == 3 %}
                            {{ question.option3 }}
                        {% elif question.correct_option == 4 %}
                            {{ question.option4 }}
                        {% endif %}
                    </p>
                </li>
                {% endfor %}
            </ul>
            {% endif %}

            <!-- Back to Dashboard Button -->
            <div class="text-center mt-4">
                <a href="{{ url_for('auth.index') }}" class="btn btn-primary">
                    <i class="fa fa-backward" aria-hidden="true"></i>
                    Go Back
                </a>
            </div>
        </div>
    </div>
</div>
<br>
<br>
<br>
{% endblock %}
